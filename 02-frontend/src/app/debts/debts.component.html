<mat-sidenav-container>
  <mat-sidenav #snav style="width: 220px;" fixedTopGap="80" [mode]="'side'" [fixedInViewport]="true">
    <!--    add your sidenav content here-->
  </mat-sidenav>

  <mat-sidenav-content>
    <div class="container-xxl mt-5">
      <button mat-icon-button (click)="snav.toggle()" class="sidenav-button">
        <mat-icon>menu</mat-icon>
      </button>

      <table mat-table [dataSource]="partsDataSource" matSort
             class="mat-elevation-z8" #partsTable>



        <ng-container matColumnDef="menu">
          <th mat-header-cell *matHeaderCellDef>
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text" class="centered-button-cell">
            <div class="centered-button-container">
              <button mat-icon-button [matMenuTriggerFor]="menu">
                <mat-icon>more_vert</mat-icon>
              </button>
            </div>

            <mat-menu #menu="matMenu">
<!--              <button mat-menu-item (click)="openPolicyModal(policy, policy_modal)">Полис</button>-->
<!--              <button mat-menu-item (click)="openPolicyFolder(policy.folder)">Папка</button>-->
<!--              <button mat-menu-item (click)="onEditClientModal(policy.client, client_edit_modal)">Клиент</button>-->
<!--              <button mat-menu-item (click)="onPolicyProlongation(policy)">Продление</button>-->
<!--              <button mat-menu-item (click)="openSmsModal(policy, sms_modal)">SMS</button>-->
            </mat-menu>

          </td>
        </ng-container>

        <ng-container matColumnDef="policyType">
          <th mat-header-cell *matHeaderCellDef>
            Тип
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.policy.policyType?.type}} </td>
        </ng-container>

        <ng-container matColumnDef="policyType">
          <th mat-header-cell *matHeaderCellDef>
            Опл
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.policy.paymentType?.prefix}} </td>
        </ng-container>

        <ng-container matColumnDef="client">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by client">
            Клиент
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.policy.client?.name}} </td>
        </ng-container>

        <ng-container matColumnDef="object">
          <th mat-header-cell *matHeaderCellDef>
            Объект
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.policy.object}} </td>
        </ng-container>

        <ng-container matColumnDef="insurer">
          <th mat-header-cell *matHeaderCellDef  mat-sort-header sortActionDescription="Sort by insurer">
            СК
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.policy.insurer?.name}} </td>
        </ng-container>

        <ng-container matColumnDef="agent">
          <th mat-header-cell *matHeaderCellDef  mat-sort-header sortActionDescription="Sort by agent">
            Аг
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.policy.agent?.prefix}} </td>
        </ng-container>

        <ng-container matColumnDef="policyNumber">
          <th mat-header-cell *matHeaderCellDef>
            Полис
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text bold"> {{part.policy.policyNumber}} </td>
        </ng-container>

        <ng-container matColumnDef="startDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by startDate">
            Начало
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{ part.policy.startDate | date: "dd.MM.yyyy" }}</td>
        </ng-container>

        <ng-container matColumnDef="endDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by endDate">
            Конец
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{ part.policy.endDate | date: "dd.MM.yyyy" }} </td>
        </ng-container>

        <ng-container matColumnDef="policySum">
          <th mat-header-cell *matHeaderCellDef>
            Сумма
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.policy.sum}} </td>
        </ng-container>

        <ng-container matColumnDef="parts">
          <th mat-header-cell *matHeaderCellDef>
            Ч
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.policy.parts}}/{{part.part}} </td>
        </ng-container>

        <ng-container matColumnDef="endDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by endDate">
            Дата
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{ part.policy.date | date: "dd.MM.yyyy" }} </td>
        </ng-container>

        <ng-container matColumnDef="invoice">
          <th mat-header-cell *matHeaderCellDef>
            Счет
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.invoice?.invoiceNumber}} </td>
        </ng-container>

        <ng-container matColumnDef="endDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by endDate">
            Макс.
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text">
            {{ (part.date ? part.date + 10 * 24 * 60 * 60 * 1000 : '') | date: "dd.MM.yyyy" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="paymentSum">
          <th mat-header-cell *matHeaderCellDef>
            Сумма
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.sum}} </td>
        </ng-container>

        <ng-container matColumnDef="paymentSum">
          <th mat-header-cell *matHeaderCellDef>
            %
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.policy.percent}}% </td>
        </ng-container>

        <ng-container matColumnDef="paymentSum">
          <th mat-header-cell *matHeaderCellDef>
            Провиз
          </th>
          <td mat-cell *matCellDef="let part" class="truncate-text"> {{part.policy.provision / part.policy.parts}} </td>
        </ng-container>


        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>
  </mat-sidenav-content>

</mat-sidenav-container>
